# -*- mode: makefile -*-
# Copyright (c) Facebook, Inc. and its affiliates.

# Mac OS X (Darwin) hints file
# This is for MacOS 10.14.

# This hints file can build several different types of installations.
# Edit the next section to match the type of build you need.

# Included window systems
WANT_WIN_TTY=1
WANT_WIN_RL=1

# default window system is TTY
WANT_DEFAULT=tty

GAMEUID  = games
GAMEGRP  = $(GAMEUID)

CC=gcc -Wall -Wextra -Wno-missing-field-initializers -Wimplicit
CC+= -Wreturn-type -Wunused -Wformat -Wswitch -Wshadow -Wwrite-strings -DGCC_WARN

CFLAGS=-g -I../include
CXXFLAGS=$(CFLAGS) -I.

CFLAGS+=-DNOCLIPPING -DNOMAIL -DNOTPARMDECL -DHACKDIR=\"$(HACKDIR)\"
CFLAGS+= -DDEFAULT_WINDOW_SYS=\"$(WANT_DEFAULT)\" -DDLB

# Required for TTY
WINSRC = $(WINTTYSRC)
WINOBJ = $(WINTTYOBJ)
WINLIB = $(WINTTYLIB)
WINTTYLIB=-lncurses

# Required for RL
CXXFLAGS += -std=c++14 -stdlib=libc++ -mmacosx-version-min=10.7
LINK=g++
WINSRC += $(WINRLSRC)
WINLIB += $(WINRLLIB)
WINOBJ += $(WINRLOBJ)

# Normally defined by setup.py (or manually by the user)
ifdef PREFIX
HACKDIR=$(PREFIX)/lib/games/nethack
else # !PREFIX
PREFIX:=$(wildcard ~)
HACKDIR=$(PREFIX)/nethackdir
endif

SHELLDIR=$(PREFIX)/bin
INSTDIR=$(HACKDIR)
VARDIR=$(HACKDIR)
CHOWN=true
CHGRP=true
GAMEPERM = 0700
VARFILEPERM = 0600
VARDIRPERM = 0700
POSTINSTALL= touch $(INSTDIR)/sysconf
